version: v1.1.0
workingDirectory: ./Src
steps:
# Build target image
# The image targets the Run.Registry, the registry where the task is run, and is tagged with a unique ACR Tasks run ID.
- build: -t {{.Run.Registry}}/web.razor:{{.Run.ID}} -f ./Clients/Shopping.Razor/Dockerfile .
# Run image in a temporary container. This example starts a long-running container in the background and returns the container ID, then stops the container. 
# In a real-world scenario, you might include steps to test the running container to ensure it runs correctly.
- cmd: -t {{.Run.Registry}}/web.razor:{{.Run.ID}}
  id: test
  detach: true
  ports: ["8080:80"]
- cmd: docker stop test
# Push image pushes the image that was built to the run registry
- push:
  - {{.Run.Registry}}/web.razor:{{.Run.ID}}